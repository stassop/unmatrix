!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);Object.defineProperty(t,"CircularLinkedList",{enumerable:!0,get:function(){return r.CircularLinkedList}});var i=n(4);Object.defineProperty(t,"Line",{enumerable:!0,get:function(){return i.Line}});var s=n(9);Object.defineProperty(t,"LineSegment",{enumerable:!0,get:function(){return s.LineSegment}});var l=n(6);Object.defineProperty(t,"LinkedList",{enumerable:!0,get:function(){return l.LinkedList}});var a=n(10);Object.defineProperty(t,"LinkedListNode",{enumerable:!0,get:function(){return a.LinkedListNode}});var o=n(3);Object.defineProperty(t,"Matrix",{enumerable:!0,get:function(){return o.Matrix}});var u=n(5);Object.defineProperty(t,"Plane",{enumerable:!0,get:function(){return u.Plane}});var h=n(7);Object.defineProperty(t,"Polygon",{enumerable:!0,get:function(){return h.Polygon}});var c=n(1);Object.defineProperty(t,"Vector",{enumerable:!0,get:function(){return c.Vector}});var f=n(11);Object.defineProperty(t,"Vertex",{enumerable:!0,get:function(){return f.Vertex}});var m=n(12);Object.defineProperty(t,"mht",{enumerable:!0,get:function(){return m.mht}}),Object.defineProperty(t,"makeLookAt",{enumerable:!0,get:function(){return m.makeLookAt}}),Object.defineProperty(t,"makePerspective",{enumerable:!0,get:function(){return m.makePerspective}}),Object.defineProperty(t,"makeFrustum",{enumerable:!0,get:function(){return m.makeFrustum}}),Object.defineProperty(t,"makeOrtho",{enumerable:!0,get:function(){return m.makeOrtho}});var v=n(2);Object.defineProperty(t,"PRECISION",{enumerable:!0,get:function(){return v.PRECISION}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(3),s=n(2);var l=t.Vector=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setElements(t)}return r(e,[{key:"e",value:function(e){return e<1||e>this.elements.length?null:this.elements[e-1]}},{key:"dimensions",value:function(){return this.elements.length}},{key:"modulus",value:function(){return Math.sqrt(this.dot(this))}},{key:"eql",value:function(e){var t=this.elements.length,n=e.elements||e;if(t!==n.length)return!1;for(;t--;)if(Math.abs(this.elements[t]-n[t])>s.PRECISION)return!1;return!0}},{key:"dup",value:function(){return new e(this.elements)}},{key:"map",value:function(t,n){var r=[];return this.each(function(e,i){r.push(t.call(n,e,i))}),new e(r)}},{key:"forEach",value:function(e,t){for(var n=this.elements.length,r=0;r<n;r++)e.call(t,this.elements[r],r+1)}},{key:"toUnitVector",value:function(){var e=this.modulus();return 0===e?this.dup():this.map(function(t){return t/e})}},{key:"angleFrom",value:function(e){var t=e.elements||e,n=this.elements.length;if(n!==t.length)return null;var r=0,i=0,s=0;if(this.each(function(e,n){r+=e*t[n-1],i+=e*e,s+=t[n-1]*t[n-1]}),i=Math.sqrt(i),s=Math.sqrt(s),i*s==0)return null;var l=r/(i*s);return l<-1&&(l=-1),l>1&&(l=1),Math.acos(l)}},{key:"isParallelTo",value:function(e){var t=this.angleFrom(e);return null===t?null:t<=s.PRECISION}},{key:"isAntiparallelTo",value:function(e){var t=this.angleFrom(e);return null===t?null:Math.abs(t-Math.PI)<=s.PRECISION}},{key:"isPerpendicularTo",value:function(e){var t=this.dot(e);return null===t?null:Math.abs(t)<=s.PRECISION}},{key:"add",value:function(e){var t=e.elements||e;return this.elements.length!==t.length?null:this.map(function(e,n){return e+t[n-1]})}},{key:"subtract",value:function(e){var t=e.elements||e;return this.elements.length!==t.length?null:this.map(function(e,n){return e-t[n-1]})}},{key:"multiply",value:function(e){return this.map(function(t){return t*e})}},{key:"dot",value:function(e){var t=e.elements||e,n=0,r=this.elements.length;if(r!==t.length)return null;for(;r--;)n+=this.elements[r]*t[r];return n}},{key:"cross",value:function(t){var n=t.elements||t;if(3!==this.elements.length||3!==n.length)return null;var r=this.elements;return new e([r[1]*n[2]-r[2]*n[1],r[2]*n[0]-r[0]*n[2],r[0]*n[1]-r[1]*n[0]])}},{key:"max",value:function(){for(var e=0,t=this.elements.length;t--;)Math.abs(this.elements[t])>Math.abs(e)&&(e=this.elements[t]);return e}},{key:"indexOf",value:function(e){for(var t=null,n=this.elements.length,r=0;r<n;r++)null===t&&this.elements[r]===e&&(t=r+1);return t}},{key:"toDiagonalMatrix",value:function(){return i.Matrix.Diagonal(this.elements)}},{key:"round",value:function(){return this.map(function(e){return Math.round(e)})}},{key:"snapTo",value:function(e){return this.map(function(t){return Math.abs(t-e)<=s.PRECISION?e:t})}},{key:"distanceFrom",value:function(e){if(e.anchor||e.start&&e.end)return e.distanceFrom(this);var t=e.elements||e;if(t.length!==this.elements.length)return null;var n,r=0;return this.each(function(e,i){n=e-t[i-1],r+=n*n}),Math.sqrt(r)}},{key:"liesOn",value:function(e){return e.contains(this)}},{key:"liesIn",value:function(e){return e.contains(this)}},{key:"rotate",value:function(t,n){var r,s,l,a,o=null;switch(t.determinant&&(o=t.elements),this.elements.length){case 2:return 2!==(r=n.elements||n).length?null:(o||(o=i.Matrix.Rotation(t).elements),s=this.elements[0]-r[0],l=this.elements[1]-r[1],new e([r[0]+o[0][0]*s+o[0][1]*l,r[1]+o[1][0]*s+o[1][1]*l]));case 3:if(!n.direction)return null;var u=n.pointClosestTo(this).elements;return o||(o=i.Matrix.Rotation(t,n.direction).elements),s=this.elements[0]-u[0],l=this.elements[1]-u[1],a=this.elements[2]-u[2],new e([u[0]+o[0][0]*s+o[0][1]*l+o[0][2]*a,u[1]+o[1][0]*s+o[1][1]*l+o[1][2]*a,u[2]+o[2][0]*s+o[2][1]*l+o[2][2]*a]);default:return null}}},{key:"reflectionIn",value:function(t){if(t.anchor){var n=this.elements.slice(),r=t.pointClosestTo(n).elements;return new e([r[0]+(r[0]-n[0]),r[1]+(r[1]-n[1]),r[2]+(r[2]-(n[2]||0))])}var i=t.elements||t;return this.elements.length!==i.length?null:this.map(function(e,t){return i[t-1]+(i[t-1]-e)})}},{key:"to3D",value:function(){var e=this.dup();switch(e.elements.length){case 3:break;case 2:e.elements.push(0);break;default:return null}return e}},{key:"inspect",value:function(){return"["+this.elements.join(", ")+"]"}},{key:"setElements",value:function(e){return this.elements=(e.elements||e).slice(),this}},{key:"flatten",value:function(){return this.elements}}]),e}();l.Random=function(e){for(var t=[];e--;)t.push(Math.random());return new l(t)},l.Zero=function(e){for(var t=[];e--;)t.push(0);return new l(t)},l.prototype.x=l.prototype.multiply,l.prototype.each=l.prototype.forEach,l.i=new l([1,0,0]),l.j=new l([0,1,0]),l.k=new l([0,0,1])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PRECISION=1e-6},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=n(1);var l=t.Matrix=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setElements(t)}return r(e,[{key:"e",value:function(e,t){return e<1||e>this.elements.length||t<1||t>this.elements[0].length?null:this.elements[e-1][t-1]}},{key:"row",value:function(e){return e>this.elements.length?null:new s.Vector(this.elements[e-1])}},{key:"col",value:function(e){if(0===this.elements.length)return null;if(e>this.elements[0].length)return null;for(var t=[],n=this.elements.length,r=0;r<n;r++)t.push(this.elements[r][e-1]);return new s.Vector(t)}},{key:"dimensions",value:function(){var e=0===this.elements.length?0:this.elements[0].length;return{rows:this.elements.length,cols:e}}},{key:"rows",value:function(){return this.elements.length}},{key:"cols",value:function(){return 0===this.elements.length?0:this.elements[0].length}},{key:"eql",value:function(t){var n=t.elements||t;if(n[0]&&void 0!==n[0][0]||(n=new e(n).elements),0===this.elements.length||0===n.length)return this.elements.length===n.length;if(this.elements.length!==n.length)return!1;if(this.elements[0].length!==n[0].length)return!1;for(var r,s=this.elements.length,l=this.elements[0].length;s--;)for(r=l;r--;)if(Math.abs(this.elements[s][r]-n[s][r])>i.PRECISION)return!1;return!0}},{key:"dup",value:function(){return new e(this.elements)}},{key:"map",value:function(t,n){if(0===this.elements.length)return new e([]);for(var r,i=[],s=this.elements.length,l=this.elements[0].length;s--;)for(r=l,i[s]=[];r--;)i[s][r]=t.call(n,this.elements[s][r],s+1,r+1);return new e(i)}},{key:"isSameSizeAs",value:function(t){var n=t.elements||t;return void 0===n[0][0]&&(n=new e(n).elements),0===this.elements.length?0===n.length:this.elements.length===n.length&&this.elements[0].length===n[0].length}},{key:"add",value:function(t){if(0===this.elements.length)return this.map(function(e){return e});var n=t.elements||t;return void 0===n[0][0]&&(n=new e(n).elements),this.isSameSizeAs(n)?this.map(function(e,t,r){return e+n[t-1][r-1]}):null}},{key:"subtract",value:function(t){if(0===this.elements.length)return this.map(function(e){return e});var n=t.elements||t;return void 0===n[0][0]&&(n=new e(n).elements),this.isSameSizeAs(n)?this.map(function(e,t,r){return e-n[t-1][r-1]}):null}},{key:"canMultiplyFromLeft",value:function(t){if(0===this.elements.length)return!1;var n=t.elements||t;return void 0===n[0][0]&&(n=new e(n).elements),this.elements[0].length===n.length}},{key:"multiply",value:function(t){if(0===this.elements.length)return null;if(!t.elements)return this.map(function(e){return e*t});var n=!!t.modulus;if(void 0===(h=t.elements||t)[0][0]&&(h=new e(h).elements),!this.canMultiplyFromLeft(h))return null;for(var r,i,s,l=this.elements.length,a=h[0].length,o=this.elements[0].length,u=[];l--;)for(r=a,u[l]=[];r--;){for(i=o,s=0;i--;)s+=this.elements[l][i]*h[i][r];u[l][r]=s}var h=new e(u);return n?h.col(1):h}},{key:"minor",value:function(t,n,r,i){if(0===this.elements.length)return null;for(var s,l,a,o=[],u=r,h=this.elements.length,c=this.elements[0].length;u--;)for(o[s=r-u-1]=[],l=i;l--;)a=i-l-1,o[s][a]=this.elements[(t+s-1)%h][(n+a-1)%c];return new e(o)}},{key:"transpose",value:function(){if(0===this.elements.length)return new e([]);for(var t,n=this.elements.length,r=[],i=this.elements[0].length;i--;)for(t=n,r[i]=[];t--;)r[i][t]=this.elements[t][i];return new e(r)}},{key:"isSquare",value:function(){var e=0===this.elements.length?0:this.elements[0].length;return this.elements.length===e}},{key:"max",value:function(){if(0===this.elements.length)return null;for(var e,t=0,n=this.elements.length,r=this.elements[0].length;n--;)for(e=r;e--;)Math.abs(this.elements[n][e])>Math.abs(t)&&(t=this.elements[n][e]);return t}},{key:"indexOf",value:function(e){if(0===this.elements.length)return null;var t,n,r=this.elements.length,i=this.elements[0].length;for(t=0;t<r;t++)for(n=0;n<i;n++)if(this.elements[t][n]===e)return{i:t+1,j:n+1};return null}},{key:"diagonal",value:function(){if(!this.isSquare)return null;for(var e=[],t=this.elements.length,n=0;n<t;n++)e.push(this.elements[n][n]);return new s.Vector(e)}},{key:"toRightTriangular",value:function(){if(0===this.elements.length)return new e([]);var t,n,r,i,s=this.dup(),l=this.elements.length,a=this.elements[0].length;for(n=0;n<l;n++){if(0===s.elements[n][n])for(r=n+1;r<l;r++)if(0!==s.elements[r][n]){for(t=[],i=0;i<a;i++)t.push(s.elements[n][i]+s.elements[r][i]);s.elements[n]=t;break}if(0!==s.elements[n][n])for(r=n+1;r<l;r++){var o=s.elements[r][n]/s.elements[n][n];for(t=[],i=0;i<a;i++)t.push(i<=n?0:s.elements[r][i]-s.elements[n][i]*o);s.elements[r]=t}}return s}},{key:"determinant",value:function(){if(0===this.elements.length)return 1;if(!this.isSquare())return null;for(var e=this.toRightTriangular(),t=e.elements[0][0],n=e.elements.length,r=1;r<n;r++)t*=e.elements[r][r];return t}},{key:"isSingular",value:function(){return this.isSquare()&&0===this.determinant()}},{key:"trace",value:function(){if(0===this.elements.length)return 0;if(!this.isSquare())return null;for(var e=this.elements[0][0],t=this.elements.length,n=1;n<t;n++)e+=this.elements[n][n];return e}},{key:"rank",value:function(){if(0===this.elements.length)return 0;for(var e,t=this.toRightTriangular(),n=0,r=this.elements.length,s=this.elements[0].length;r--;)for(e=s;e--;)if(Math.abs(t.elements[r][e])>i.PRECISION){n++;break}return n}},{key:"augment",value:function(t){if(0===this.elements.length)return this.dup();var n=t.elements||t;void 0===n[0][0]&&(n=new e(n).elements);var r,i=this.dup(),s=i.elements[0].length,l=i.elements.length,a=n[0].length;if(l!==n.length)return null;for(;l--;)for(r=a;r--;)i.elements[l][s+r]=n[l][r];return i}},{key:"inverse",value:function(){if(0===this.elements.length)return null;if(!this.isSquare()||this.isSingular())return null;for(var t,n,r,i,s,l=this.elements.length,a=l,o=this.augment(e.I(l)).toRightTriangular(),u=o.elements[0].length,h=[];a--;){for(r=[],h[a]=[],i=o.elements[a][a],n=0;n<u;n++)s=o.elements[a][n]/i,r.push(s),n>=l&&h[a].push(s);for(o.elements[a]=r,t=a;t--;){for(r=[],n=0;n<u;n++)r.push(o.elements[t][n]-o.elements[a][n]*o.elements[t][a]);o.elements[t]=r}}return new e(h)}},{key:"round",value:function(){return this.map(function(e){return Math.round(e)})}},{key:"snapTo",value:function(e){return this.map(function(t){return Math.abs(t-e)<=i.PRECISION?e:t})}},{key:"inspect",value:function(){var e=[],t=this.elements.length;if(0===t)return"[]";for(var n=0;n<t;n++)e.push(new s.Vector(this.elements[n]).inspect());return e.join("\n")}},{key:"setElements",value:function(e){var t,n,r=e.elements||e;if(r[0]&&void 0!==r[0][0]){for(t=r.length,this.elements=[];t--;)for(n=r[t].length,this.elements[t]=[];n--;)this.elements[t][n]=r[t][n];return this}var i=r.length;for(this.elements=[],t=0;t<i;t++)this.elements.push([r[t]]);return this}},{key:"flatten",value:function(){var e=[];if(0==this.elements.length)return[];for(var t=0;t<this.elements[0].length;t++)for(var n=0;n<this.elements.length;n++)e.push(this.elements[n][t]);return e}},{key:"ensure4x4",value:function(){if(4==this.elements.length&&4==this.elements[0].length)return this;if(this.elements.length>4||this.elements[0].length>4)return null;for(var e=0;e<this.elements.length;e++)for(var t=this.elements[e].length;t<4;t++)e==t?this.elements[e].push(1):this.elements[e].push(0);for(e=this.elements.length;e<4;e++)0==e?this.elements.push([1,0,0,0]):1==e?this.elements.push([0,1,0,0]):2==e?this.elements.push([0,0,1,0]):3==e&&this.elements.push([0,0,0,1]);return this}},{key:"make3x3",value:function(){return 4!=this.elements.length||4!=this.elements[0].length?null:new e([[this.elements[0][0],this.elements[0][1],this.elements[0][2]],[this.elements[1][0],this.elements[1][1],this.elements[1][2]],[this.elements[2][0],this.elements[2][1],this.elements[2][2]]])}}]),e}();l.I=function(e){for(var t,n=[],r=e;r--;)for(t=e,n[r]=[];t--;)n[r][t]=r===t?1:0;return new l(n)},l.Diagonal=function(e){for(var t=e.length,n=l.I(t);t--;)n.elements[t][t]=e[t];return n},l.Rotation=function(e,t){if(!t)return new l([[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]]);var n=t.dup();if(3!==n.elements.length)return null;var r=n.modulus(),i=n.elements[0]/r,s=n.elements[1]/r,a=n.elements[2]/r,o=Math.sin(e),u=Math.cos(e),h=1-u;return new l([[h*i*i+u,h*i*s-o*a,h*i*a+o*s],[h*i*s+o*a,h*s*s+u,h*s*a-o*i],[h*i*a-o*s,h*s*a+o*i,h*a*a+u]])},l.RotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return new l([[1,0,0],[0,t,-n],[0,n,t]])},l.RotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return new l([[t,0,n],[0,1,0],[-n,0,t]])},l.RotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return new l([[t,-n,0],[n,t,0],[0,0,1]])},l.Random=function(e,t){return l.Zero(e,t).map(function(){return Math.random()})},l.Translation=function(e){var t;if(2==e.elements.length)return(t=l.I(3)).elements[2][0]=e.elements[0],t.elements[2][1]=e.elements[1],t;if(3==e.elements.length)return(t=l.I(4)).elements[0][3]=e.elements[0],t.elements[1][3]=e.elements[1],t.elements[2][3]=e.elements[2],t;throw"Invalid length for Translation"},l.Zero=function(e,t){for(var n,r=[],i=e;i--;)for(n=t,r[i]=[];n--;)r[i][n]=0;return new l(r)},l.prototype.toUpperTriangular=l.prototype.toRightTriangular,l.prototype.det=l.prototype.determinant,l.prototype.tr=l.prototype.trace,l.prototype.rk=l.prototype.rank,l.prototype.inv=l.prototype.inverse,l.prototype.x=l.prototype.multiply},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Line=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=n(1),l=n(3),a=n(5);var o=t.Line=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setVectors(t,n)}return r(e,[{key:"eql",value:function(e){return this.isParallelTo(e)&&this.contains(e.anchor)}},{key:"dup",value:function(){return new e(this.anchor,this.direction)}},{key:"translate",value:function(t){var n=t.elements||t;return new e([this.anchor.elements[0]+n[0],this.anchor.elements[1]+n[1],this.anchor.elements[2]+(n[2]||0)],this.direction)}},{key:"isParallelTo",value:function(e){if(e.normal||e.start&&e.end)return e.isParallelTo(this);var t=this.direction.angleFrom(e.direction);return Math.abs(t)<=i.PRECISION||Math.abs(t-Math.PI)<=i.PRECISION}},{key:"distanceFrom",value:function(e){if(e.normal||e.start&&e.end)return e.distanceFrom(this);if(e.direction){if(this.isParallelTo(e))return this.distanceFrom(e.anchor);var t=this.direction.cross(e.direction).toUnitVector().elements,n=this.anchor.elements,r=e.anchor.elements;return Math.abs((n[0]-r[0])*t[0]+(n[1]-r[1])*t[1]+(n[2]-r[2])*t[2])}var i=e.elements||e,s=(n=this.anchor.elements,this.direction.elements),l=i[0]-n[0],a=i[1]-n[1],o=(i[2]||0)-n[2],u=Math.sqrt(l*l+a*a+o*o);if(0===u)return 0;var h=(l*s[0]+a*s[1]+o*s[2])/u,c=1-h*h;return Math.abs(u*Math.sqrt(c<0?0:c))}},{key:"contains",value:function(e){if(e.start&&e.end)return this.contains(e.start)&&this.contains(e.end);var t=this.distanceFrom(e);return null!==t&&t<=i.PRECISION}},{key:"positionOf",value:function(e){if(!this.contains(e))return null;var t=e.elements||e,n=this.anchor.elements,r=this.direction.elements;return(t[0]-n[0])*r[0]+(t[1]-n[1])*r[1]+((t[2]||0)-n[2])*r[2]}},{key:"liesIn",value:function(e){return e.contains(this)}},{key:"intersects",value:function(e){return e.normal?e.intersects(this):!this.isParallelTo(e)&&this.distanceFrom(e)<=i.PRECISION}},{key:"intersectionWith",value:function(e){if(e.normal||e.start&&e.end)return e.intersectionWith(this);if(!this.intersects(e))return null;var t=this.anchor.elements,n=this.direction.elements,r=e.anchor.elements,i=e.direction.elements,l=n[0],a=n[1],o=n[2],u=i[0],h=i[1],c=i[2],f=t[0]-r[0],m=t[1]-r[1],v=t[2]-r[2],d=u*u+h*h+c*c,p=l*u+a*h+o*c,y=((-l*f-a*m-o*v)*d/(l*l+a*a+o*o)+p*(u*f+h*m+c*v))/(d-p*p);return new s.Vector([t[0]+y*l,t[1]+y*a,t[2]+y*o])}},{key:"pointClosestTo",value:function(e){if(e.start&&e.end)return null===(f=e.pointClosestTo(this))?null:this.pointClosestTo(f);if(e.direction){if(this.intersects(e))return this.intersectionWith(e);if(this.isParallelTo(e))return null;var t=this.direction.elements,n=e.direction.elements,r=t[0],i=t[1],l=t[2],o=n[0],u=n[1],h=n[2],c=[(y=l*o-r*h)*h-(g=r*u-i*o)*u,g*o-(k=i*h-l*u)*h,k*u-y*o];return(f=new a.Plane(e.anchor,c)).intersectionWith(this)}var f=e.elements||e;if(this.contains(f))return new s.Vector(f);var m=this.anchor.elements,v=(r=(t=this.direction.elements)[0],i=t[1],l=t[2],m[0]),d=m[1],p=m[2],y=r*(f[1]-d)-i*(f[0]-v),g=i*((f[2]||0)-p)-l*(f[1]-d),k=l*(f[0]-v)-r*((f[2]||0)-p),w=new s.Vector([i*y-l*k,l*g-r*y,r*k-i*g]),b=this.distanceFrom(f)/w.modulus();return new s.Vector([f[0]+w.elements[0]*b,f[1]+w.elements[1]*b,(f[2]||0)+w.elements[2]*b])}},{key:"rotate",value:function(t,n){void 0===n.direction&&(n=new e(n.to3D(),s.Vector.k));var r=l.Matrix.Rotation(t,n.direction).elements,i=n.pointClosestTo(this.anchor).elements,a=this.anchor.elements,o=this.direction.elements,u=i[0],h=i[1],c=i[2],f=a[0]-u,m=a[1]-h,v=a[2]-c;return new e([u+r[0][0]*f+r[0][1]*m+r[0][2]*v,h+r[1][0]*f+r[1][1]*m+r[1][2]*v,c+r[2][0]*f+r[2][1]*m+r[2][2]*v],[r[0][0]*o[0]+r[0][1]*o[1]+r[0][2]*o[2],r[1][0]*o[0]+r[1][1]*o[1]+r[1][2]*o[2],r[2][0]*o[0]+r[2][1]*o[1]+r[2][2]*o[2]])}},{key:"reverse",value:function(){return new e(this.anchor,this.direction.x(-1))}},{key:"reflectionIn",value:function(t){if(t.normal){var n=this.anchor.elements,r=this.direction.elements,i=n[0],s=n[1],l=n[2],a=r[0],o=r[1],u=r[2],h=this.anchor.reflectionIn(t).elements,c=i+a,f=s+o,m=l+u,v=t.pointClosestTo([c,f,m]).elements;return new e(h,[v[0]+(v[0]-c)-h[0],v[1]+(v[1]-f)-h[1],v[2]+(v[2]-m)-h[2]])}if(t.direction)return this.rotate(Math.PI,t);var d=t.elements||t;return new e(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.direction)}},{key:"setVectors",value:function(e,t){if(e=new s.Vector(e),t=new s.Vector(t),2===e.elements.length&&e.elements.push(0),2===t.elements.length&&t.elements.push(0),e.elements.length>3||t.elements.length>3)return null;var n=t.modulus();return 0===n?null:(this.anchor=e,this.direction=new s.Vector([t.elements[0]/n,t.elements[1]/n,t.elements[2]/n]),this)}}]),e}();o.X=new o(s.Vector.Zero(3),s.Vector.i),o.Y=new o(s.Vector.Zero(3),s.Vector.j),o.Z=new o(s.Vector.Zero(3),s.Vector.k)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plane=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=n(3),l=n(1),a=n(4);var o=t.Plane=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setVectors(t,n,r)}return r(e,[{key:"eql",value:function(e){return this.contains(e.anchor)&&this.isParallelTo(e)}},{key:"dup",value:function(){return new e(this.anchor,this.normal)}},{key:"translate",value:function(t){var n=t.elements||t;return new e([this.anchor.elements[0]+n[0],this.anchor.elements[1]+n[1],this.anchor.elements[2]+(n[2]||0)],this.normal)}},{key:"isParallelTo",value:function(e){var t;return e.normal?(t=this.normal.angleFrom(e.normal),Math.abs(t)<=i.PRECISION||Math.abs(Math.PI-t)<=i.PRECISION):e.direction?this.normal.isPerpendicularTo(e.direction):null}},{key:"isPerpendicularTo",value:function(e){var t=this.normal.angleFrom(e.normal);return Math.abs(Math.PI/2-t)<=i.PRECISION}},{key:"distanceFrom",value:function(e){if(this.intersects(e)||this.contains(e))return 0;if(e.anchor){var t=this.anchor.elements,n=e.anchor.elements,r=this.normal.elements;return Math.abs((t[0]-n[0])*r[0]+(t[1]-n[1])*r[1]+(t[2]-n[2])*r[2])}var i=e.elements||e;t=this.anchor.elements,r=this.normal.elements;return Math.abs((t[0]-i[0])*r[0]+(t[1]-i[1])*r[1]+(t[2]-(i[2]||0))*r[2])}},{key:"contains",value:function(e){if(e.normal)return null;if(e.direction)return this.contains(e.anchor)&&this.contains(e.anchor.add(e.direction));var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements;return Math.abs(r[0]*(n[0]-t[0])+r[1]*(n[1]-t[1])+r[2]*(n[2]-(t[2]||0)))<=i.PRECISION}},{key:"intersects",value:function(e){return void 0===e.direction&&void 0===e.normal?null:!this.isParallelTo(e)}},{key:"intersectionWith",value:function(e){if(!this.intersects(e))return null;if(e.direction){var t=e.anchor.elements,n=e.direction.elements,r=this.anchor.elements,i=((u=this.normal.elements)[0]*(r[0]-t[0])+u[1]*(r[1]-t[1])+u[2]*(r[2]-t[2]))/(u[0]*n[0]+u[1]*n[1]+u[2]*n[2]);return new l.Vector([t[0]+n[0]*i,t[1]+n[1]*i,t[2]+n[2]*i])}if(e.normal){for(var o=this.normal.cross(e.normal).toUnitVector(),u=this.normal.elements,h=(t=this.anchor.elements,e.normal.elements),c=e.anchor.elements,f=s.Matrix.Zero(2,2),m=0;f.isSingular();)m++,f=new s.Matrix([[u[m%3],u[(m+1)%3]],[h[m%3],h[(m+1)%3]]]);for(var v=f.inverse().elements,d=u[0]*t[0]+u[1]*t[1]+u[2]*t[2],p=h[0]*c[0]+h[1]*c[1]+h[2]*c[2],y=[v[0][0]*d+v[0][1]*p,v[1][0]*d+v[1][1]*p],g=[],k=1;k<=3;k++)g.push(m===k?0:y[(k+(5-m)%3)%3]);return new a.Line(g,o)}}},{key:"pointClosestTo",value:function(e){var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements,i=(n[0]-t[0])*r[0]+(n[1]-t[1])*r[1]+(n[2]-(t[2]||0))*r[2];return new l.Vector([t[0]+r[0]*i,t[1]+r[1]*i,(t[2]||0)+r[2]*i])}},{key:"rotate",value:function(t,n){var r=t.determinant?t.elements:s.Matrix.Rotation(t,n.direction).elements,i=n.pointClosestTo(this.anchor).elements,l=this.anchor.elements,a=this.normal.elements,o=i[0],u=i[1],h=i[2],c=l[0]-o,f=l[1]-u,m=l[2]-h;return new e([o+r[0][0]*c+r[0][1]*f+r[0][2]*m,u+r[1][0]*c+r[1][1]*f+r[1][2]*m,h+r[2][0]*c+r[2][1]*f+r[2][2]*m],[r[0][0]*a[0]+r[0][1]*a[1]+r[0][2]*a[2],r[1][0]*a[0]+r[1][1]*a[1]+r[1][2]*a[2],r[2][0]*a[0]+r[2][1]*a[1]+r[2][2]*a[2]])}},{key:"reflectionIn",value:function(t){if(t.normal){var n=this.anchor.elements,r=this.normal.elements,i=n[0],s=n[1],l=n[2],a=r[0],o=r[1],u=r[2],h=this.anchor.reflectionIn(t).elements,c=i+a,f=s+o,m=l+u,v=t.pointClosestTo([c,f,m]).elements;return new e(h,[v[0]+(v[0]-c)-h[0],v[1]+(v[1]-f)-h[1],v[2]+(v[2]-m)-h[2]])}if(t.direction)return this.rotate(Math.PI,t);var d=t.elements||t;return new e(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.normal)}},{key:"setVectors",value:function(e,t,n){if(null===(e=(e=new l.Vector(e)).to3D()))return null;if(null===(t=(t=new l.Vector(t)).to3D()))return null;if(void 0===n)n=null;else if(null===(n=(n=new l.Vector(n)).to3D()))return null;var r,i,s=e.elements[0],a=e.elements[1],o=e.elements[2],u=t.elements[0],h=t.elements[1],c=t.elements[2];if(null!==n){var f=n.elements[0],m=n.elements[1],v=n.elements[2];if(0===(i=(r=new l.Vector([(h-a)*(v-o)-(c-o)*(m-a),(c-o)*(f-s)-(u-s)*(v-o),(u-s)*(m-a)-(h-a)*(f-s)])).modulus()))return null;r=new l.Vector([r.elements[0]/i,r.elements[1]/i,r.elements[2]/i])}else{if(0===(i=Math.sqrt(u*u+h*h+c*c)))return null;r=new l.Vector([t.elements[0]/i,t.elements[1]/i,t.elements[2]/i])}return this.anchor=e,this.normal=r,this}}]),e}();o.XY=new o(l.Vector.Zero(3),l.Vector.k),o.YZ=new o(l.Vector.Zero(3),l.Vector.i),o.ZX=new o(l.Vector.Zero(3),l.Vector.j),o.YX=o.XY,o.ZY=o.YZ,o.XZ=o.ZX,o.fromPoints=function(e){var t,n,r,s,a,u,h,c,f,m,v=e.length,d=[],p=l.Vector.Zero(3);for(t=0;t<v;t++){if(null===(n=new l.Vector(e[t]).to3D()))return null;if(d.push(n),(r=d.length)>2){if(a=d[r-1].elements,u=d[r-2].elements,h=d[r-3].elements,s=new l.Vector([(a[1]-u[1])*(h[2]-u[2])-(a[2]-u[2])*(h[1]-u[1]),(a[2]-u[2])*(h[0]-u[0])-(a[0]-u[0])*(h[2]-u[2]),(a[0]-u[0])*(h[1]-u[1])-(a[1]-u[1])*(h[0]-u[0])]).toUnitVector(),r>3&&null!==(f=s.angleFrom(m))&&!(Math.abs(f)<=i.PRECISION||Math.abs(f-Math.PI)<=i.PRECISION))return null;p=p.add(s),m=s}}return a=d[1].elements,u=d[0].elements,h=d[r-1].elements,c=d[r-2].elements,p=p.add(new l.Vector([(a[1]-u[1])*(h[2]-u[2])-(a[2]-u[2])*(h[1]-u[1]),(a[2]-u[2])*(h[0]-u[0])-(a[0]-u[0])*(h[2]-u[2]),(a[0]-u[0])*(h[1]-u[1])-(a[1]-u[1])*(h[0]-u[0])]).toUnitVector()).add(new l.Vector([(u[1]-h[1])*(c[2]-h[2])-(u[2]-h[2])*(c[1]-h[1]),(u[2]-h[2])*(c[0]-h[0])-(u[0]-h[0])*(c[2]-h[2]),(u[0]-h[0])*(c[1]-h[1])-(u[1]-h[1])*(c[0]-h[0])]).toUnitVector()),new o(d[0],p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=t.LinkedList=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.length=0,this.first=null,this.last=null}return r(e,[{key:"forEach",value:function(e,t){for(var n=this.first,r=this.length,i=0;i<r;i++)e.call(t,n,i),n=n.next}},{key:"at",value:function(e){if(!(e>=0&&e<this.length))return null;for(var t=this.first;e--;)t=t.next;return t}},{key:"randomNode",value:function(){var e=Math.floor(Math.random()*this.length);return this.at(e)}},{key:"toArray",value:function(){for(var e=[],t=this.first,n=this.length;n--;)e.push(t.data||t),t=t.next;return e}}]),e}();i.prototype.each=i.prototype.forEach},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Polygon=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),s=n(2),l=n(3),a=n(1),o=n(5),u=n(4);t.Polygon=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setVertices(t,n)}return r(e,[{key:"v",value:function(e){return this.vertices.at(e-1).data}},{key:"nodeFor",value:function(e){return this.vertices.withData(e)}},{key:"dup",value:function(){return new e(this.vertices,this.plane)}},{key:"translate",value:function(e){var t=e.elements||e;return this.vertices.each(function(e){var n=e.data.elements;e.data.setElements([n[0]+t[0],n[1]+t[1],n[2]+(t[2]||0)])}),this.plane=this.plane.translate(e),this.updateTrianglePlanes(function(t){return t.translate(e)}),this}},{key:"rotate",value:function(e,t){var n=l.Matrix.Rotation(e,t.direction);return this.vertices.each(function(e){e.data.setElements(e.data.rotate(n,t).elements)}),this.plane=this.plane.rotate(n,t),this.updateTrianglePlanes(function(e){return e.rotate(n,t)}),this}},{key:"scale",value:function(e,t){var n=t.elements||t;this.vertices.each(function(t){var r=t.data.elements;t.data.setElements([n[0]+e*(r[0]-n[0]),n[1]+e*(r[1]-n[1]),(n[2]||0)+e*(r[2]-(n[2]||0))])});var r=this.vertices.first.data;return this.plane.anchor.setElements(r),this.updateTrianglePlanes(function(e){return new o.Plane(r,e.normal)}),this}},{key:"updateTrianglePlanes",value:function(e){var t;if(null!==this.cached.triangles)for(t=this.cached.triangles.length;t--;)this.cached.triangles[t].plane=e(this.cached.triangles[t].plane);if(null!==this.cached.surfaceIntegralElements)for(t=this.cached.surfaceIntegralElements.length;t--;)this.cached.surfaceIntegralElements[t].plane=e(this.cached.surfaceIntegralElements[t].plane)}},{key:"isTriangle",value:function(){return 3===this.vertices.length}},{key:"trianglesForSurfaceIntegral",value:function(){if(null!==this.cached.surfaceIntegralElements)return this.cached.surfaceIntegralElements;var t=[],n=this.vertices.first.data,r=this.plane;return this.vertices.each(function(i,s){if(!(s<2)){var l=[n,i.prev.data,i.data];t.push(new e(l,o.Plane.fromPoints(l)||r))}}),this.setCache("surfaceIntegralElements",t)}},{key:"area",value:function(){if(this.isTriangle()){var e=this.vertices.first,t=e.next,n=t.next;return e=e.data.elements,t=t.data.elements,n=n.data.elements,.5*new a.Vector([(e[1]-t[1])*(n[2]-t[2])-(e[2]-t[2])*(n[1]-t[1]),(e[2]-t[2])*(n[0]-t[0])-(e[0]-t[0])*(n[2]-t[2]),(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])]).modulus()}for(var r=this.trianglesForSurfaceIntegral(),i=0,s=r.length;s--;)i+=r[s].area()*r[s].plane.normal.dot(this.plane.normal);return i}},{key:"centroid",value:function(){if(this.isTriangle()){var e=this.v(1).elements,t=this.v(2).elements,n=this.v(3).elements;return new a.Vector([(e[0]+t[0]+n[0])/3,(e[1]+t[1]+n[1])/3,(e[2]+t[2]+n[2])/3])}for(var r,i=0,s=a.Vector.Zero(3),l=this.trianglesForSurfaceIntegral(),o=l.length;o--;)i+=e=l[o].area()*l[o].plane.normal.dot(this.plane.normal),r=s.elements,n=l[o].centroid().elements,s.setElements([r[0]+n[0]*e,r[1]+n[1]*e,r[2]+n[2]*e]);return s.x(1/i)}},{key:"projectionOn",value:function(t){var n=[];return this.vertices.each(function(e){n.push(t.pointClosestTo(e.data))}),new e(n)}},{key:"removeVertex",value:function(e){if(!this.isTriangle()){var t=this.nodeFor(e);if(null===t)return null;this.clearCache();var n=t.prev,r=t.next,s=n.data.isConvex(this),l=r.data.isConvex(this);return t.data.isConvex(this)?this.convexVertices.remove(this.convexVertices.withData(t.data)):this.reflexVertices.remove(this.reflexVertices.withData(t.data)),this.vertices.remove(t),s!==n.data.isConvex(this)&&(s?(this.convexVertices.remove(this.convexVertices.withData(n.data)),this.reflexVertices.append(new i.LinkedList.Node(n.data))):(this.reflexVertices.remove(this.reflexVertices.withData(n.data)),this.convexVertices.append(new i.LinkedList.Node(n.data)))),l!==r.data.isConvex(this)&&(l?(this.convexVertices.remove(this.convexVertices.withData(r.data)),this.reflexVertices.append(new i.LinkedList.Node(r.data))):(this.reflexVertices.remove(this.reflexVertices.withData(r.data)),this.convexVertices.append(new i.LinkedList.Node(r.data)))),this}}},{key:"contains",value:function(e){return this.containsByWindingNumber(e)}},{key:"containsByWindingNumber",value:function(e){var t=e.elements||e;if(!this.plane.contains(t))return!1;if(this.hasEdgeContaining(t))return!1;var n,r,i,l,o,u=0,h=0,c=this;return this.vertices.each(function(e){n=e.data.elements,r=e.next.data.elements,i=new a.Vector([n[0]-t[0],n[1]-t[1],n[2]-(t[2]||0)]),l=new a.Vector([r[0]-t[0],r[1]-t[1],r[2]-(t[2]||0)]),null!==(o=i.angleFrom(l))&&0!==o&&((u+=(i.cross(l).isParallelTo(c.plane.normal)?1:-1)*o)>=2*Math.PI-s.PRECISION&&(h++,u-=2*Math.PI),u<=-2*Math.PI+s.PRECISION&&(h--,u+=2*Math.PI))}),0!==h}},{key:"hasEdgeContaining",value:function(e){var t=e.elements||e,n=!1;return this.vertices.each(function(e){u.Line.Segment.create(e.data,e.next.data).contains(t)&&(n=!0)}),n}},{key:"toTriangles",value:function(){return null!==this.cached.triangles?this.cached.triangles:this.setCache("triangles",this.triangulateByEarClipping())}},{key:"triangulateByEarClipping",value:function(){for(var t,n,r,i,s=this.dup(),l=[];!s.isTriangle();){for(t=!1;!t;)t=!0,n=s.convexVertices.randomNode(),r=s.vertices.withData(n.data),i=new e([r.data,r.next.data,r.prev.data],this.plane),s.reflexVertices.each(function(e){e.data!==r.prev.data&&e.data!==r.next.data&&(i.contains(e.data)||i.hasEdgeContaining(e.data))&&(t=!1)});l.push(i),s.removeVertex(r.data)}return l.push(new e(s.vertices,this.plane)),l}},{key:"setVertices",value:function(t,n){var r=t.toArray?t.toArray():t;if(this.plane=n&&n.normal?n.dup():o.Plane.fromPoints(r),null===this.plane)return null;this.vertices=new i.LinkedList.Circular;for(var s,l=r.length;l--;)s=r[l].isConvex?r[l]:new e.Vertex(r[l]),this.vertices.prepend(new i.LinkedList.Node(s));return this.clearCache(),this.populateVertexTypeLists(),this}},{key:"populateVertexTypeLists",value:function(){this.convexVertices=new i.LinkedList.Circular,this.reflexVertices=new i.LinkedList.Circular;var e=this;this.vertices.each(function(t){e[t.data.type(e)+"Vertices"].append(new i.LinkedList.Node(t.data))})}},{key:"copyVertices",value:function(){this.clearCache(),this.vertices.each(function(t){t.data=new e.Vertex(t.data)}),this.populateVertexTypeLists()}},{key:"clearCache",value:function(){this.cached={triangles:null,surfaceIntegralElements:null}}},{key:"setCache",value:function(e,t){return this.cached[e]=t,t}},{key:"inspect",value:function(){var e=[];return this.vertices.each(function(t){e.push(t.data.inspect())}),e.join(" -> ")}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircularLinkedList=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6);var s=t.CircularLinkedList=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.LinkedList),r(t,[{key:"append",value:function(e){null===this.first?(e.prev=e,e.next=e,this.first=e,this.last=e):(e.prev=this.last,e.next=this.first,this.first.prev=e,this.last.next=e,this.last=e),this.length++}},{key:"prepend",value:function(e){null!==this.first?(e.prev=this.last,e.next=this.first,this.first.prev=e,this.last.next=e,this.first=e,this.length++):this.append(e)}},{key:"insertAfter",value:function(e,t){t.prev=e,t.next=e.next,e.next.prev=t,e.next=t,t.prev===this.last&&(this.last=t),this.length++}},{key:"insertBefore",value:function(e,t){t.prev=e.prev,t.next=e,e.prev.next=t,e.prev=t,t.next===this.first&&(this.first=t),this.length++}},{key:"remove",value:function(e){this.length>1?(e.prev.next=e.next,e.next.prev=e.prev,e===this.first&&(this.first=e.next),e===this.last&&(this.last=e.prev)):(this.first=null,this.last=null),e.prev=null,e.next=null,this.length--}},{key:"withData",value:function(e){for(var t=this.first,n=this.last,r=Math.ceil(this.length/2);r--;){if(t.data===e)return t;if(n.data===e)return n;t=t.next,n=n.prev}return null}}]),t}();s.fromArray=function(e,t){for(var n=new s,r=e.length;r--;)n.prepend(t?new i.LinkedList.Node(e[r]):e[r]);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineSegment=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),s=n(5),l=n(4);t.LineSegment=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setPoints(t,n)}return r(e,[{key:"eql",value:function(e){return this.start.eql(e.start)&&this.end.eql(e.end)||this.start.eql(e.end)&&this.end.eql(e.start)}},{key:"dup",value:function(){return new e(this.start,this.end)}},{key:"length",value:function(){var e=this.start.elements,t=this.end.elements,n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},{key:"toVector",value:function(){var e=this.start.elements,t=this.end.elements;return new i.Vector([t[0]-e[0],t[1]-e[1],t[2]-e[2]])}},{key:"midpoint",value:function(){var e=this.start.elements,t=this.end.elements;return new i.Vector([(t[0]+e[0])/2,(t[1]+e[1])/2,(t[2]+e[2])/2])}},{key:"bisectingPlane",value:function(){return new s.Plane(this.midpoint(),this.toVector())}},{key:"translate",value:function(t){var n=t.elements||t,r=this.start.elements,i=this.end.elements;return new e([r[0]+n[0],r[1]+n[1],r[2]+(n[2]||0)],[i[0]+n[0],i[1]+n[1],i[2]+(n[2]||0)])}},{key:"isParallelTo",value:function(e){return this.line.isParallelTo(e)}},{key:"distanceFrom",value:function(e){var t=this.pointClosestTo(e);return null===t?null:t.distanceFrom(e)}},{key:"contains",value:function(e){if(e.start&&e.end)return this.contains(e.start)&&this.contains(e.end);var t=(e.elements||e).slice();if(2===t.length&&t.push(0),this.start.eql(t))return!0;var n=this.start.elements,r=new i.Vector([n[0]-t[0],n[1]-t[1],n[2]-(t[2]||0)]),s=this.toVector();return r.isAntiparallelTo(s)&&r.modulus()<=s.modulus()}},{key:"intersects",value:function(e){return null!==this.intersectionWith(e)}},{key:"intersectionWith",value:function(e){if(!this.line.intersects(e))return null;var t=this.line.intersectionWith(e);return this.contains(t)?t:null}},{key:"pointClosestTo",value:function(e){if(e.normal){var t=this.line.intersectionWith(e);return null===t?null:this.pointClosestTo(t)}var n=this.line.pointClosestTo(e);return null===n?null:this.contains(n)?n:(this.line.positionOf(n)<0?this.start:this.end).dup()}},{key:"setPoints",value:function(e,t){return e=new i.Vector(e).to3D(),t=new i.Vector(t).to3D(),null===e||null===t?null:(this.line=new l.Line(e,t.subtract(e)),this.start=e,this.end=t,this)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LinkedListNode=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.prev=null,this.next=null,this.data=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vertex=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),s=n(2);n(7);function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=t.Vertex=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=l(this,Object.getPrototypeOf(t).call(this,e));return n.setElements(e),2===n.elements.length&&n.elements.push(0),3!==n.elements.length?(null,l(n,null)):n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Vector),r(t,[{key:"isConvex",value:function(e){var t=e.nodeFor(this);if(null===t)return null;var n=t.prev.data,r=t.next.data.subtract(this),i=n.subtract(this),l=r.angleFrom(i);return l<=s.PRECISION||!(Math.abs(l-Math.PI)<=s.PRECISION)&&r.cross(i).dot(e.plane.normal)>0}},{key:"isReflex",value:function(e){var t=this.isConvex(e);return null===t?null:!t}},{key:"type",value:function(e){var t=this.isConvex(e);return null===t?null:t?"convex":"reflex"}}]),t}();a.convert=function(e){for(var t=e.toArray?e.toArray():e,n=[],r=t.length,i=0;i<r;i++)n.push(new a(t[i]));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mht=function(e){var t="";if(16==e.length)for(var n=0;n<4;n++)t+="<span style='font-family: monospace'>["+e[4*n+0].toFixed(4)+","+e[4*n+1].toFixed(4)+","+e[4*n+2].toFixed(4)+","+e[4*n+3].toFixed(4)+"]</span><br>";else{if(9!=e.length)return e.toString();for(var n=0;n<3;n++)t+="<span style='font-family: monospace'>["+e[3*n+0].toFixed(4)+","+e[3*n+1].toFixed(4)+","+e[3*n+2].toFixed(4)+"]</font><br>"}return t},t.makeLookAt=function(e,t,n,s,l,a,o,u,h){var c=new r.Vector([e,t,n]),f=new r.Vector([s,l,a]),m=new r.Vector([o,u,h]),v=c.subtract(f).toUnitVector(),d=m.cross(v).toUnitVector(),p=v.cross(d).toUnitVector(),y=new i.Matrix([[d.e(1),d.e(2),d.e(3),0],[p.e(1),p.e(2),p.e(3),0],[v.e(1),v.e(2),v.e(3),0],[0,0,0,1]]),g=new i.Matrix([[1,0,0,-e],[0,1,0,-t],[0,0,1,-n],[0,0,0,1]]);return y.x(g)},t.makeOrtho=s,t.makePerspective=function(e,t,n,r){var i=n*Math.tan(e*Math.PI/360),s=-i;return l(s*t,i*t,s,i,n,r)},t.makeFrustum=l,t.makeOrtho=s;var r=n(1),i=n(3);function s(e,t,n,r,s,l){var a=-(t+e)/(t-e),o=-(r+n)/(r-n),u=-(l+s)/(l-s);return new i.Matrix([[2/(t-e),0,0,a],[0,2/(r-n),0,o],[0,0,-2/(l-s),u],[0,0,0,1]])}function l(e,t,n,r,s,l){var a=2*s/(t-e),o=2*s/(r-n),u=(t+e)/(t-e),h=(r+n)/(r-n),c=-(l+s)/(l-s),f=-2*l*s/(l-s);return new i.Matrix([[a,0,u,0],[0,o,h,0],[0,0,c,f],[0,0,-1,0]])}function s(e,t,n,r,s,l){var a=-(t+e)/(t-e),o=-(r+n)/(r-n),u=-(l+s)/(l-s);return new i.Matrix([[2/(t-e),0,0,a],[0,2/(r-n),0,o],[0,0,-2/(l-s),u],[0,0,0,1]])}},function(e,t,n){"use strict";n.r(t);var r=n(0);var i=new class{rad2deg(e){return e*(180/Math.PI)}determinant(e){return Object(r.Matrix)(e).determinant()}inverse(e){return Object(r.Matrix)(e).inverse().elements}transpose(e){return Object(r.Matrix)(e).transpose().elements}multVecMatrix(e,t){return Object(r.Matrix)(t).multiply(e).elements}length(e){return Object(r.Vector)(e).modulus()}normalize(e){return Object(r.Vector)(e).toUnitVector().elements}dot(e,t){return Object(r.Vector)(e).dot(t)}cross(e,t){return Object(r.Vector)(e).cross(t).elements}combine(e,t,n,r){let i=[];return i[0]=n*e[0]+r*t[0],i[1]=n*e[1]+r*t[1],3===e.length&&3===t.length&&(i[2]=n*e[2]+r*t[2]),i}decompose(e){let t={};if(0===e[3][3])return null;for(let t=0;t<4;t++)for(let n=0;n<4;n++)e[t][n]/=e[3][3];let n,r=e;for(let e=0;e<3;e++)r[e][3]=0;if(r[3][3]=1,0===this.determinant(r))return null;if(0!==e[0][3]||0!==e[1][3]||0!==e[2][3]){let t=[];t[0]=e[0][3],t[1]=e[1][3],t[2]=e[2][3],t[3]=e[3][3],this.inverse(r);let i=this.transpose(inversePerspectiveMatrix);n=this.multVecMatrix(t,i),e[0][3]=e[1][3]=e[2][3]=0,e[3][3]=1}else(n=[])[0]=n[1]=n[2]=0,n[3]=1;t.translateX=e[3][0],t.translateY=e[3][1],t.translateZ=e[3][2];let i=[[],[],[]];for(let t=0;t<3;t++)i[t][0]=e[t][0],i[t][1]=e[t][1],i[t][2]=e[t][2];let s=this.length(i[0]);i[0]=this.normalize(i[0]);let l=this.dot(i[0],i[1]);i[1]=this.combine(i[1],i[0],1,-l);let a=this.length(i[1]);i[1]=this.normalize(i[1]),l/=a;let o=this.dot(i[0],i[2]);i[2]=this.combine(i[2],i[0],1,-o);let u=this.dot(i[1],i[2]);i[2]=this.combine(i[2],i[1],1,-u);let h=this.length(i[2]);i[2]=this.normalize(i[2]),o/=h,u/=h,t.skewX=this.rad2deg(o),t.skewY=this.rad2deg(u);let c=cross(i[1],i[2]);if(this.dot(i[0],c)<0)for(let e=0;e<3;e++)s*=-1,i[e][0]*=-1,i[e][1]*=-1,i[e][2]*=-1;return t.scaleX=s,t.scaleY=a,t.scaleZ=h,t.rotateY=Math.asin(-i[0][2]),0!==Math.cos(t.rotateY)?(t.rotateX=Math.atan2(i[1][2],i[2][2]),t.rotateZ=Math.atan2(i[0][1],i[0][0])):(t.rotateX=Math.atan2(-i[2][0],i[1][1]),t.rotateZ=0),t}getTransform(e){if(!(e instanceof HTMLElement))return null;let t=getComputedStyle(e);if(!("transform"in t)||"none"===t.transform)return null;let n=t.transform,r=n.includes("matrix3d"),i=(n=(n=n.match(/\((.+)\)/)[1]).split(",")).map(e=>parseFloat(e)),s=r?[[i[0],i[1],i[2],i[3]],[i[4],i[5],i[6],i[7]],[i[8],i[9],i[10],i[11]],[i[12],i[13],i[14],i[15]]]:[[i[0],i[1],0,0],[i[2],i[3],0,0],[0,0,1,0],[i[4],i[5],0,1]];return this.decompose(s)}};const s=document.querySelector("#el1"),l=i.getTransform(s),a=`translate(${l.translateX}px,${l.translateY}px)\n  rotate(${l.rotateZ}deg)\n  skew(${l.skewX}deg)\n  scale(${l.scaleX},${l.scaleY})`;document.querySelector("#el2").style.transform=a}]);